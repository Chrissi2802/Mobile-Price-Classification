# Mobile Price Classification üì±üí∞
This repository contains a possible solution for the Kaggle task [Mobile Price Classification](https://www.kaggle.com/iabhishekofficial/mobile-price-classification).

Classes for data handling, training, prediction and evaluation are implemented.
There is also a frontend and a backend available for the web-based application of the ml model inference.


## Data üíΩ 
The data comes from [Kaggle](https://www.kaggle.com/datasets/iabhishekofficial/mobile-price-classification/data) and is not public in this repository. However, they can be easily downloaded from Kaggle.

The data is already divided into training and test set by Kaggle.
There are 2000 records with 20 features and a label available as training data. The features are all numerical and the label is a class/category with 4 different values.
A further 16 features can be generated by feature engineering. 
The test data contains 1000 data records with 20 features and no label, but an ID.


## Exploratory Data Analysis üìä
The data is analyzed and visualized in a [Jupyter Notebook](https://jupyter.org/).
At the beginning, a brief overview is given of what data handling provides and what the data looks like.
This is followed by a description of the features and the distribution of the data for each feature.
The Pearson correlation, the Predictive Power Score (PPS) and the Maximum Information Coefficient (MIC) are then calculated and visualised for all feature combinations. This should help to find relevant features.
Some relevant features are analysed in more detail at the end.


## Machine Learning ‚ú®
Three different models are trained and evaluated.
- [Logistic Regression](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html)
- [Random Forest](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html)
- [XGBoost](https://xgboost.readthedocs.io/en/stable/index.html)

The experiments and models are tracked with [mlflow](https://mlflow.org/) and can be visualized and evaluated with ```mlflow ui```.


### Procedure of the training
1. the data is [split](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html) into training and validation data
2. the best hyperparameters for the model are searched for with [GridSearchCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html)
3. the data is scaled with [StandardScaler](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html)
4. the model is trained with the best hyperparameters
5. the model is evaluated and the results are tracked with mlflow


### Inference
Inference can be carried out directly in [Python](https://www.python.org/) or via a web-based application.


## Web-based Application üíª
There is a frontend and a backend. The frontend is implemented in [HTML](https://www.w3.org/html/) and [JavaScript](https://www.javascript.com/), the backend in Python. The frontend communicates with the backend via a [Fast API](https://fastapi.tiangolo.com/). 
The backend loads the trained model and performs the inference. The result is returned to the frontend and displayed.

Executing the web application:
1. start backend, execute [backend.py](src/backend.py)
2. start frontend, open [frontend.html](src/frontend.html) in the browser
3. enter data and view result


### Backend
The backend searches for the best model in mlfow and loads it. 
It receives the features from the front end.
It performs the inference and returns the result.


### Frontend
The frontend has an input mask via which the 20 characteristics are transferred as a list and an output for the result.
The predicted class, the probability of all classes and a status message are displayed.


## Folder Structure üìÅ
| Folder       | Description       |
| ------------ | ----------------- |
| [data](data) | contains the data |
| [mlruns](mlruns) | contains the mlflow runs / experiments |
| [notebooks](notebooks) | contains the notebooks for data exploration and model training |
| [reports](reports) | contains the reports (confusion matrix, learning curve, etc.) |
| [src](src) | contains the source code |


## Development
- [Visual Studio Code](https://code.visualstudio.com/)
- Support from [GitHub Copilot](https://github.com/features/copilot)
- [Python](https://www.python.org/downloads/) 3.10.9


## License
This project is licensed under the [Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0).

